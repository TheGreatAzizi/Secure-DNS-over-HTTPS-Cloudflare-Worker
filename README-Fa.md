# ๐ก๏ธ Secure DNS over HTTPS (DoH)

### **ูุทูุฆูโุชุฑู DNS Resolver ุจุง ูุนูุงุฑ Parallel Racing ุฑู Cloudflare Workers**

[![Cloudflare Workers](https://img.shields.io/badge/Platform-Cloudflare_Workers-F38020?logo=cloudflare)](https://workers.cloudflare.com)
[![Architecture](https://img.shields.io/badge/Architecture-Parallel_Racing_v4.5-emerald)](https://github.com/TheGreatAzizi/Secure-DNS-over-HTTPS-Cloudflare-Worker)
[![Security](https://img.shields.io/badge/Privacy-Zero_Logging-teal)](https://x.com/the_azzi)
[![Interface](https://img.shields.io/badge/UI-English_Persian_Chinese-0ea5e9)](https://github.com/TheGreatAzizi/Secure-DNS-over-HTTPS-Cloudflare-Worker)

ฺฉ Cloudflare Worker ฺฉู ฺฉ **ุงูุฏูพููุช ุงุฎุชุตุงุต ู Enterprise-Grade ุจุฑุง DNS over HTTPS (DoH)** ุจู ููุฑุงู ฺฉ ุฏุงุดุจูุฑุฏ ูุฏุฑู ู ุขููุฒุด ุงุฑุงุฆู ูโุฏูุฏ. ุงู ูพุฑูฺู ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุงููู ุงุฎุชุตุงุต ุฎูุฏุชุงู ุฑู ุดุจฺฉู Edge ฺฉูุงุฏููุฑุ ุฏุฑุฎูุงุณุชโูุง DNS ุฑุง ุฑูุฒูฺฏุงุฑ ฺฉูุฏุ DNS Poisoning ุฑุง ุฏูุฑ ุจุฒูุฏ ู ุญุฑู ุฎุตูุต ุฎูุฏ ุฑุง ุจูุจูุฏ ุฏูุฏ.

**ุฏูู:** [dns.theazizi.ir](https://dns.theazizi.ir) |  
**ุงูุฏูพููุช:** `https://dns.theazizi.ir/dns-query`

---

## โ ูฺฉุงุช ููู (ูุฎุตูุตุงู ุจุฑุง ฺฉุงุฑุจุฑุงู ุฏุงุฎู ุงุฑุงู)

### 1. ุณุงุจโุฏุงููโูุง Workers ูุณุฏูุฏ ูุณุชูุฏ
ุฏุงูููโูุง ูพุดโูุฑุถ Cloudflare Workers (`*.workers.dev`) ุฏุงุฎู ุงุฑุงู ุจูโุตูุฑุช ฺฉุงูู ููุชุฑ ูุณุชูุฏ. ุดูุง **ุญุชูุงู ุจุงุฏ Worker ุฑุง ุจู ุฏุงููู ุง ุณุงุจโุฏุงูู ุงุฎุชุตุงุต ุฎูุฏุชุงู ูุชุตู ฺฉูุฏ** (ูุซูุงู: `dns.yourdomain.com`) ุงุฒ ุทุฑู:

**Workers โ Settings โ Domains & Routes**

ุญุชูุงู ูุทูุฆู ุดูุฏ ฺฉู **Orange Cloud (Proxied)** ูุนุงู ุจุงุดุฏ.

### 2. ููุท DNS ุฑูุฒูฺฏุงุฑ ูโุดูุฏ โ IP ุดูุง ุชุบุฑ ููโฺฉูุฏ
ุงู ูพุฑูฺู **ููุท ุฏุฑุฎูุงุณุชโูุง DNS ุฑุง ุฑูุฒูฺฏุงุฑ ูโฺฉูุฏ**.  
ุขุฏุฑุณ IP ุนููู ุดูุง **ุชุบุฑ ูุฎูุงูุฏ ฺฉุฑุฏ**.

- ุงฺฏุฑ ุจุง ุงู DNS ูุงุฑุฏ ูพูุชูุฑูโูุง ูุซู **Twitter (X)** ุดูุฏุ ุณุฑูุณ ููฺูุงู ูโุชูุงูุฏ IP ู ูููุนุช ูุงูุน ุดูุง ุฑุง ุชุดุฎุต ุฏูุฏ.
- ูุนุงูุช ูพุฑููุงู ุดูุง ุฏุฑ ุดุจฺฉูโูุง ุงุฌุชูุงุน ููฺฉู ุงุณุช ููฺูุงู ฺฉุดูุฑ ุงุชุตุงู (ูุซูุงู ุงุฑุงู) ุฑุง ูุดุงู ุฏูุฏ.

### 3. ูุญุฏูุฏูโ ุฏูุฑ ุฒุฏู ููุชุฑูฺฏ
ุงู Worker ููุชุฑูฺฏ ุฏุฑ ุณุทุญ DNS ุฑุง ุฏูุฑ ูโุฒูุฏ (ฺฉู ุจุฎุด ุจุฒุฑฺฏ ุงุฒ ุณุงูุณูุฑ ุฑุง ุดุงูู ูโุดูุฏ)ุ ุงูุง **ููฺฉู ุงุณุช ูุชูุงูุฏ ููุงุฑุฏ ุฒุฑ ุฑุง ุฏูุฑ ุจุฒูุฏ:**

- ูุณุฏูุฏุณุงุฒ ุฏุฑ ุณุทุญ IP  
- ููุชุฑูฺฏ SNI (ุจุฑ ุงุณุงุณ ูุงู ุฏุงููู ุฏุฑ TLS Handshake)  
- Deep Packet Inspection (DPI)

---

## โก ุฏุงุฎู ุงู ูุณุฎู ฺู ุฏุงุฑูุ

- **๐ ูุนูุงุฑ 8-Track Parallel Racing:**  
  ุจุฑุง ูุฑ ุฏุฑุฎูุงุณุช DNSุ ููุฒูุงู ุจู **8 ุณุฑูุณโุฏููุฏู ูุนุชุจุฑ ุฌูุงู DNS** (Googleุ Cloudflareุ Quad9ุ AdGuardุ Mullvad ู โฆ) ุฏุฑุฎูุงุณุช ุงุฑุณุงู ูโุดูุฏ.

- **๐ ุณุฑุนโุชุฑู ูพุงุณุฎ ุจุฑูุฏู ุงุณุช:**  
  ุงููู ูพุงุณุฎ ูุนุชุจุฑ ุฏุฑุงูุชโุดุฏู ุจู ฺฉุงุฑุจุฑ ุจุฑฺฏุฑุฏุงูุฏู ูโุดูุฏ ุชุง ุชุฃุฎุฑ ูุงุด ุงุฒ ฺฉูุฏ ุจูุฏู ฺฉ ุณุฑูุณโุฏููุฏู ุญุฐู ุดูุฏ.

- **๐ง ุณุณุชู ุงูุชุงุฒุฏู ููุดููุฏ:**  
  ุงฺฏุฑ ฺฉ Provider ฺฉูุฏ ุง ุณุงูุณูุฑุดุฏู ุจุงุดุฏุ ุงูุชุงุฒ ุขู ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ฺฉุงูุด ูพุฏุง ูโฺฉูุฏ ู ููุฏูุง ุณุงูู ุฌุงฺฏุฒู ูโุดููุฏ.

- **๐พ ฺฉุด ุณุฑุงุณุฑ Edge:**  
  ุฏุงูููโูุง ูพุฑุชฺฉุฑุงุฑ (ูุซู Googleุ Spotify ุง ูุงูโูุง CDN) ุฏุงุฎู ุญุงูุธู Edge ฺฉูุงุฏููุฑ ฺฉุด ูโุดููุฏ ู ูพุงุณุฎโูุง ุจุง ุฒูุงู ุฒุฑ **10 ููโุซุงูู** ุงุฑุงุฆู ูโุดูุฏ.

---

## ๐ ุงู ูพุฑูฺู ฺู ฺฉุงุฑ ุงูุฌุงู ูโุฏูุฏุ

- ุงุฑุงุฆู ุงูุฏูพููุช ุงูู `/dns-query`
- ุฌููฺฏุฑ ุงุฒ **ูุงูุชูุฑูฺฏ ุฏุฑ ุณุทุญ ISP**
- ุฌููฺฏุฑ ุงุฒ **DNS Hijacking**
- ุฑุงุจุท ฺฉุงุฑุจุฑ ฺูุฏุฒุจุงูู (ุงูฺฏูุณุ ูุงุฑุณุ ฺู)
- ุชููุฏฺฉููุฏู ูพุฑููุงู ุงุฎุชุตุงุต Apple ุจุฑุง iOS/macOS (`.mobileconfig`)
- ุงุณุชูุงุฏู ุงุฒ Decoy Request ู ูุฏุฑูุง ุชุตุงุฏู ุจุฑุง ุฌููฺฏุฑ ุงุฒ Traffic Fingerprinting

---

## ๐ ูุญูู Deploy

### 1. ุณุงุฎุช Worker
- ูุงุฑุฏ ุฏุงุดุจูุฑุฏ Cloudflare ุดูุฏ.
- ุจู ุจุฎุด **Workers & Pages** ุจุฑูุฏ ู ุฑู **Create Service** ฺฉูฺฉ ฺฉูุฏ.
- ฺฉุฏ ูุงู [worker.js](./worker.js) ุฑุง Paste ฺฉูุฏ ู ุฑู **Deploy** ุจุฒูุฏ.

### 2. ุงุชุตุงู ุฏุงููู ุงุฎุชุตุงุต (ุงูุฒุงู ุจุฑุง ููุงุทู ูุญุฏูุฏ)
- ูุงุฑุฏ ุชูุธูุงุช Worker ุดูุฏ.
- ุจู ุจุฎุด **Settings โ Domains & Routes** ุจุฑูุฏ.
- ุฏุงููู ุง ุณุงุจโุฏุงูู ุฎูุฏ ุฑุง ุงุถุงูู ฺฉูุฏ (ูุซูุงู `doh.yourdomain.com`).
- ูุทูุฆู ุดูุฏ DNS ุฑู ุญุงูุช **Proxied (Orange Cloud ูุนุงู)** ุจุงุดุฏ.

---

## ๐ง ุฑุงูููุง ุงุณุชูุงุฏู ุจุฑุง ูุฑ ุฏุณุชฺฏุงู

### ๐ ูุฑูุฑฺฏุฑูุง (ูพุดููุงุฏ โญ)
*ุงุณุชูุงุฏู ุฏุฑ ุณุทุญ ูุฑูุฑฺฏุฑ ูพุงุฏุงุฑุชุฑู ุฑูุด ุงุณุช.*

- **Chrome / Edge / Brave:**  
  Settings โ Privacy & Security โ Use secure DNS โ With: Custom โ ููฺฉ ุงูุฏูพููุช ุฎูุฏ ุฑุง Paste ฺฉูุฏ.

- **Firefox:**  
  Settings โ ุฌุณุชุฌู DNS โ DNS over HTTPS โ ุญุงูุช Max Protection โ Custom โ ููฺฉ ุฑุง ูุงุฑุฏ ฺฉูุฏ.

---

### ๐ ุฏุณุชฺฏุงูโูุง Apple (iOS / iPadOS / macOS)

- ุชูุธูุงุช ุงูพู ุงูฺฉุงู ูุงุฑุฏ ฺฉุฑุฏู ูุณุชูู ููฺฉ DoH ุฑุง ูุฏุงุฑุฏ.
- ุตูุญู ุงุตู Worker ุฎูุฏ ุฑุง ุฏุฑ Safari ุจุงุฒ ฺฉูุฏ (ูุซูุงู `https://dns.example.com`).
- ูุงุฑุฏ ุชุจ Apple ุดูุฏ ู ูพุฑููุงู ุชูุธูุงุช ุฑุง ุฏุงูููุฏ ฺฉูุฏ.
- ุฏุฑ ุขููู:  
  Settings โ Profile Downloaded โ Install

---

### ๐ฑ Android

- ุจุฎุด Private DNS ุงูุฏุฑูุฏ ููุท ุงุฒ **DOT (ูพูุฑุช 853)** ูพุดุชุจุงู ูโฺฉูุฏ.
- Cloudflare Workers ุจูโุตูุฑุช Native ุงุฒ DOT ูพุดุชุจุงู ููโฺฉูุฏ.

ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ุงูุฏุฑูุฏ ุจุงุฏ ุงุฒ ุงูพูฺฉุดูโูุง ูุงุณุท ูุซู:

- RethinkDNS
- Intra

ุงุณุชูุงุฏู ฺฉูุฏ ู ฺฏุฒูู Custom DOH ุฑุง ุงูุชุฎุงุจ ฺฉุฑุฏู ู ููฺฉ ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ.

---

### ๐ป Linux
ูโุชูุงูุฏ ุงุฒ `systemd-resolved`ุ `dnscrypt-proxy` ุง ุชูุธูุงุช ูุฑูุฑฺฏุฑ ุงุณุชูุงุฏู ฺฉูุฏ.

---

### โ ฺฉูุงูุชโูุง ูพุฑูฺฉุณ (Xray / v2rayNG)

```json
"dns": {
  "servers": [
    { "address": "https://your-custom-domain.com/dns-query", "skipFallback": true },
    "1.1.1.1"
  ],
  "queryStrategy": "UseIPv4"
}
```

---

## ๐ ูุดุฎุตุงุช ูู

- ูพุดุชุจุงู ุงุฒ ูุชุฏูุง POST ู GET (ูุฑูุช Base64)
- ููุชูุฑ Parallel Race ุฏุงุฎู Worker ุจุง AbortController
- ุณุณุชู Edge Cache ุจุง ููฺฏุงูโุณุงุฒ TTL
- ุจูููโุดุฏู ุจุฑุง Browser-Level ู ูุณุชูโูุง Xray / Sing-Box
- Rate Limit ุฎูุฏฺฉุงุฑ: 200 ุฏุฑุฎูุงุณุช ุฏุฑ ุฏููู ุจุฑุง ูุฑ IP

---

## ๐ค ุณุงุฒูุฏู ู ูพุดุชุจุงู

ุณุงุฎุชูโุดุฏู ุจุง โค๏ธ ุชูุณุท TheGreatAzizi  
X (Twitter): https://x.com/the_azzi
